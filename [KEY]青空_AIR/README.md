# 1.解包
``[KEY]青空_AIR``的解包过程比较曲折（其实是因为我太菜了）。另外还有一些原因是``AIR``的版本比较混乱，甚至采用的引擎都不太一样。如最早的采用的是``AVG32``，而后来就使用了``AVG2000``，即著名的``RealLive``引擎。<br>
这里我使用了standard edition的光盘版本，使用的是``AVG2000``引擎。不知道是不是封装的原因，可以直接观察到解压后的文件夹中有一个名为``KOE``的文件夹，里面就是所有的角色语音。而具体的游戏剧情脚本则被封装在了``Seen.txt``中。<br>
值得注意的是，``Seen.txt``并不是一个text源文件，其仍是一个封装的二进制文件。针对``RealLive``引擎制作的``RLDev``可以实现编辑。不过由于年代实在是有些久远了，``RLDev``的一些相关依赖项已经很难找到，所幸我们并不需要完整的编辑工具，只需要提取文本即可。
在本目录下有``reallive_tools.zip``，其中有``kprl.exe``，使用方式为``kprl -d -o seens -e utf8 Seen.txt``。（kprl是RLDev的一部分）<br>
# 2.处理
再进行了上述处理以后，会得到一个文件夹，里面有很多``.utf``和``.ke``文件，且按照名称一一对应。（其实并不是严格的一一对应，接下来会具体说明）<br>
``.ke``包含的是的是代码指令，而``.utf``则是具体的文本。在一些章节中，并没有具体的对话文本，所以``.utf``可能会缺失。值得一提的是，虽然后缀看着很奇怪，但这二者都是可以直接看作text源文件进行读取和编辑的。<br>
于是就有了这个脚本``Text_Extractor_for_AIR.py``，它会将``.utf``和``.ke``文件一一对应，然后提取出对话文本，最后按照说话人分好，生成``.json``文件。这里为了提高效率，直接将文本的绝对路径写入了json，如果你需要自行操作使用这个脚本，请注意修改部分代码。
同时，这个改变也使得仓库中的原来的``Dataset_Maker.py``无法使用，因此稍作修改了一份。（现在醒悟过来了之前一直在堆屎山）有时间了一定改（）
奇怪的是似乎角色有平假名和片假名两种表示，这里我也就没做处理了。请自行处理一下。比如``みすず``和``観鈴``都是神尾观铃。<br>
写到这里又想起来了似乎有堆了依托屎山......对话都是有顺序的，所以遍历utf文件的时候应该直接从上一次结束的地方开始，而不是每次都从头开始。这样可以减少很多复杂度。传一个指针就行，然而我大概是懒得改了。<br>
<br>
数据集已经上传至huggingface仓库。<https://huggingface.co/datasets/KitsuneX07/Datasets_for_AIR>